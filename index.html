<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="assets/css/styles.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blackjack Game</title>
  <style>
    /* (Keep your existing styles here) */
  </style>
</head>
<body>
  <h1>Blackjack Game</h1>

  <div class="game-container">
    <!-- Display money -->
    <div id="money-display">Money: $100</div>

    <!-- Display player and dealer cards -->
    <div class="cards-container" id="player-cards"></div>
    <div class="cards-container" id="dealer-cards"></div>

    <!-- Display totals -->
    <div class="totals" id="player-total">Player Total: 0</div>
    <div class="totals" id="dealer-total">Dealer Total: ?</div>

    <!-- Results -->
    <div id="result"></div>

    <!-- Bet input and buttons -->
    <div id="bet-section">
      <input type="number" id="bet-input" placeholder="Enter your bet" min="20" />
      <button id="start-game" onclick="startGame()">Start Game</button>
    </div>

    <div>
      <button id="hit" onclick="hit()" disabled>Hit</button>
      <button id="stand" onclick="stand()" disabled>Stand</button>
      <button id="double-down" onclick="doubleDown()" disabled>Double Down</button>
      <button id="split" onclick="split()" disabled>Split</button>
      <button id="restart" onclick="restartGame()">Restart</button>
    </div>

    <div class="bottom-section">
      Player Wins: <span id="player-wins">0</span> | Dealer Wins: <span id="dealer-wins">0</span>
    </div>
  </div>

  <script>
    const suits = ['♥', '♦', '♣', '♠'];
    const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
    let deck = [];
    let playerHand = [];
    let dealerHand = [];
    let playerTotal = 0;
    let dealerTotal = 0;
    let isGameOver = false;
    let currentBet = 0;
    let playerMoney = 100;
    let playerWins = 0;
    let dealerWins = 0;
    let canDoubleDown = false;
    let canSplit = false;

    function initializeDeck() {
      deck = [];
      for (let suit of suits) {
        for (let value of values) {
          deck.push({ suit, value });
        }
      }
      deck = shuffle(deck);
    }

    function shuffle(deck) {
      for (let i = deck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
      return deck;
    }

    function getCardValue(card) {
      if (card.value === 'A') return 11;
      if (['K', 'Q', 'J'].includes(card.value)) return 10;
      return parseInt(card.value);
    }

    function updateTotals() {
      playerTotal = playerHand.reduce((sum, card) => sum + getCardValue(card), 0);
      dealerTotal = dealerHand.reduce((sum, card) => sum + getCardValue(card), 0);
      
      // Adjust player total if the player has an Ace and the total is over 21
      playerHand.forEach(card => {
        if (card.value === 'A' && playerTotal > 21) {
          playerTotal -= 10;  // Convert Ace from 11 to 1
        }
      });
    }

    function showCards() {
      const playerCardsDiv = document.getElementById('player-cards');
      const dealerCardsDiv = document.getElementById('dealer-cards');

      playerCardsDiv.innerHTML = '';
      dealerCardsDiv.innerHTML = '';

      playerHand.forEach(card => {
        const cardDiv = document.createElement('div');
        cardDiv.classList.add('card');
        cardDiv.textContent = card.value + card.suit;
        playerCardsDiv.appendChild(cardDiv);
      });

      dealerHand.forEach((card, index) => {
        const cardDiv = document.createElement('div');
        cardDiv.classList.add('card');
        if (index === 0 && !isGameOver) {
          cardDiv.textContent = '??';
          cardDiv.classList.add('hidden');
        } else {
          cardDiv.textContent = card.value + card.suit;
        }
        dealerCardsDiv.appendChild(cardDiv);
      });

      document.getElementById('player-total').textContent = `Player Total: ${playerTotal}`;
      document.getElementById('dealer-total').textContent = isGameOver
        ? `Dealer Total: ${dealerTotal}`
        : `Dealer Total: ?`;
    }

    function startGame() {
      const betInput = document.getElementById('bet-input');
      currentBet = parseInt(betInput.value);

      if (isNaN(currentBet) || currentBet < 20 || currentBet > 5000) {
        alert("Bet must be between $20 and $5000.");
        betInput.value = ''; // Reset the bet input
        return;
      }

      if (currentBet > playerMoney) {
        alert("You don't have enough money to place that bet.");
        betInput.value = ''; // Reset the bet input
        return;
      }

      // Disable Start Game button and bet input during game
      document.getElementById('start-game').disabled = true;
      document.getElementById('bet-input').disabled = true;

      initializeDeck();
      playerHand = [deck.pop(), deck.pop()];
      dealerHand = [deck.pop(), deck.pop()];
      isGameOver = false;
      updateTotals();

      if (playerTotal === 21) {
        endGame('Blackjack! Player wins!');
        return;
      }

      showCards();
      document.getElementById('result').textContent = '';
      document.getElementById('hit').disabled = false;
      document.getElementById('stand').disabled = false;
      document.getElementById('double-down').disabled = false;
      document.getElementById('split').disabled = true;
    }

    function hit() {
      if (isGameOver) return;
      playerHand.push(deck.pop());
      updateTotals();
      showCards();
      if (playerTotal > 21) {
        endGame('Player busts! Dealer wins.');
      }
    }

    function stand() {
      if (isGameOver) return;
      while (dealerTotal < 17) {
        dealerHand.push(deck.pop());
        updateTotals();
      }

      if (dealerTotal > 21) {
        endGame('Dealer busts! Player wins!');
      } else if (playerTotal > dealerTotal) {
        endGame('Player wins!');
      } else if (playerTotal < dealerTotal) {
        endGame('Dealer wins!');
      } else {
        endGame("It's a tie!");
      }
    }

    function doubleDown() {
      if (isGameOver || playerMoney < currentBet * 2) return;
      currentBet *= 2;
      hit();
      if (!isGameOver) stand();
    }

    function split() {
      // Optional: Implement split functionality
    }

    function restartGame() {
      // Reset game state
      playerHand = [];
      dealerHand = [];
      playerTotal = 0;
      dealerTotal = 0;
      isGameOver = false;
      currentBet = 0;
      playerMoney = 100;
      document.getElementById('bet-input').disabled = false;
      document.getElementById('start-game').disabled = false;
      document.getElementById('hit').disabled = true;
      document.getElementById('stand').disabled = true;
      document.getElementById('double-down').disabled = true;
      document.getElementById('split').disabled = true;
      document.getElementById('result').textContent = '';
      showCards();
      document.getElementById('money-display').textContent = `Money: $${playerMoney}`;
    }

    function endGame(resultMessage) {
      isGameOver = true;
      document.getElementById('result').textContent = resultMessage;
      document.getElementById('player-wins').textContent = playerWins;
      document.getElementById('dealer-wins').textContent = dealerWins;
      // Update money display after the game ends
      if (resultMessage.includes("Player wins")) {
        playerMoney += currentBet;
        playerWins++;
      } else if (resultMessage.includes("Dealer wins")) {
        playerMoney -= currentBet;
        dealerWins++;
      }
      document.getElementById('money-display').textContent = `Money: $${playerMoney}`;
      document.getElementById('start-game').disabled = false; // Re-enable start game button after game end
    }
  </script>
</body>
</html>
